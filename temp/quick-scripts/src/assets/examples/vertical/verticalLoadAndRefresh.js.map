{"version":3,"sources":["assets/examples/vertical/verticalLoadAndRefresh.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UISuperLayout from '../../cores/UISuperLayout';\nimport { UISuperHeaderAndFooterEvent } from '../../cores/UISuperScrollView';\nimport verticalItem from './verticalItem';\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport default class verticalLoadAndRefresh extends cc.Component {\n    @property(cc.Node) header: cc.Node = null\n    @property(cc.Node) footer: cc.Node = null\n    @property(UISuperLayout) layout: UISuperLayout = null\n    private refreshTotal: number = 1\n    private total = 10\n    private datas: any[] = []\n    onLoad() {\n        this.header.scaleY = 0\n        this.footer.scaleY = 0\n    }\n    private onRefreshEvent(node: cc.Node, index: number) {\n        let info = this.datas[index]\n        node.getComponent(verticalItem).show(info, index, this.onRemove.bind(this))\n    }\n    private onRemove(index: number) {\n        this.datas.splice(index, 1)\n        this.layout.total(this.datas.length)\n    }\n    private gotoHeader() {\n        this.layout.scrollToHeader(0.618)\n    }\n    private gotoFooter() {\n        this.layout.scrollToFooter(0.618)\n    }\n    private gotoMain() {\n        cc.director.loadScene('main')\n    }\n\n    private onHeaderEvent(scrollView: any, event: UISuperHeaderAndFooterEvent) {\n        this.header.opacity = event.progress * 255\n        let label = this.header.getComponentInChildren(cc.Label)\n        if (event.progressStage == \"touch\") {\n            label.string = \"↓ 下拉刷新\"\n        }\n        if (event.progressStage == \"wait\") {\n            label.string = \"↑ 松开刷新\"\n        }\n        if (event.progressStage == \"lock\") {\n            label.string = this.datas.length == 0 ? \"没有数据\" : \"刷新中...\"\n        }\n        if (event.progressStage == 'release') {\n            label.string = \"\"\n        }\n        if (event.progress > 2) {\n            if (!this.header['playing']) {\n                this.header.runAction(cc.scaleTo(0.618, 1, 1).easing(cc.easeElasticOut(0.236)))\n                this.header['playing'] = true\n            }\n        } else {\n            this.header.stopAllActions()\n            this.header['playing'] = false\n            this.header.scaleY = event.progress\n        }\n        if (event.action) {\n            for (let i = 0; i < this.datas.length; i++) {\n                const info = this.datas[i];\n                info.message = `${i} - (刷新次数${this.refreshTotal})`\n            }\n            this.scheduleOnce(() => this.layout.total(this.datas.length), 0.5)\n            this.refreshTotal++\n        }\n    }\n\n    private onFooterEvent(scrollView: any, event: UISuperHeaderAndFooterEvent) {\n        this.footer.opacity = event.progress * 255\n        let label = this.footer.getComponentInChildren(cc.Label)\n\n        if (event.progressStage == \"touch\") {\n            label.string = \"↑ 上拉加载\"\n        }\n        if (event.progressStage == \"wait\") {\n            label.string = \"↓ 松开加载\"\n        }\n        if (event.progressStage == \"lock\") {\n            label.string = \"加载中...\"\n        }\n        if (event.progressStage == 'release') {\n            label.string = \"\"\n        }\n        if (event.progress > 2) {\n            if (!this.footer['playing']) {\n                this.footer.runAction(cc.scaleTo(0.618, 1, 1).easing(cc.easeElasticOut(0.236)))\n                this.footer['playing'] = true\n            }\n        } else {\n            this.footer.stopAllActions()\n            this.footer['playing'] = false\n            this.footer.scaleY = event.progress\n        }\n        if (event.action) {\n            for (let i = 0; i < this.total; i++) {\n                this.datas.push({ message: `${this.datas.length}` })\n            }\n            this.scheduleOnce(() => this.layout.total(this.datas.length), 0.5)\n        }\n    }\n}\n"]}